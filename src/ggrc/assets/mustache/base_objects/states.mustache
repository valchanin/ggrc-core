{{!
    Copyright (C) 2017 Google Inc.
    Licensed under http://www.apache.org/licenses/LICENSE-2.0 <see LICENSE file>
}}

{{#instance.workflow_state}}
  <div class="person-holder">
    <a href="{{instance.viewLink}}#task_widget" class="info-action person-tooltip-trigger" data-placement="left">
      {{#switch instance.workflow_state}}
        {{#case 'Verified'}}
          <span class="green"><em>Verified</em></span>
        {{/case}}
        {{#case 'Assigned'}}
          <span class="gray"><em>Assigned</em></span>
        {{/case}}
        {{#case 'Finished'}}
          <span class="gray"><em>Finished</em></span>
        {{/case}}
        {{#case 'InProgress'}}
          <span class="orange"><em>In progress</em></span>
        {{/case}}
        {{#case 'Overdue'}}
            <span class="error"><em>Overdue</em></span>
        {{/case}}
      {{/switch}}
      {{^is_subtree}}
        {{#with_mapping_count instance 'object_tasks'}}
          <i class="fa fa-cycle_task_group_object_task"></i>
          {{count}}
        {{/with_mapping_count}}
      {{/is_subtree}}
    </a>
    {{^is_subtree}}
    {{#with_mapping 'object_tasks' instance}}
      <div class="custom-popover-content">
        <div class="preview-container person-preview">
          <div class="profile-info">
            <h3 class="task-list-title">Current Tasks</h3>
            <ul class="popup-task-list">
              {{#object_tasks}}
                <li>
                  <div class="clearfix">
                    <div class="pull-left">
                      <i class="fa fa-cycle_task_group_object_task"></i>
                    </div>
                    <div class="task-title pull-left">
                      {{instance.title}}
                    </div>
                    <div class="task-status pull-left">
                      {{#switch instance.status}}
                        {{#case 'Verified'}}
                          <span class="green"><em>Verified</em></span>
                        {{/case}}
                        {{#case 'Assigned'}}
                          <span class="gray"><em>Assigned</em></span>
                        {{/case}}
                        {{#case 'Finished'}}
                          <span class="blue"><em>Finished</em></span>
                        {{/case}}
                        {{#case 'InProgress'}}
                          <span class="orange"><em>In progress</em></span>
                        {{/case}}
                      {{/switch}}
                      {{#if instance.isOverdue}}
                        <span class="error"><em>Overdue</em></span>
                      {{/if}}
                    </div>
                  </div>
                </li>
              {{/object_tasks}}
            </ul>
            <a class="info-action" href="{{instance.viewLink}}#task_widget"><i class="fa fa-long-arrow-right"></i> Open tasks</a>
          </div>
        </div>
      </div>
    {{/with_mapping}}
    {{/is_subtree}}
  </div>
{{/instance.workflow_state}}
